// ============================================
// Store Defaults - Default values for the store
// ============================================

import type { LLMConfig, AppSettings, PromptTemplate, Persona, LorebookSettings, ContextSettings } from '@/types';

export const defaultLLMConfig: LLMConfig = {
  id: 'default',
  name: 'Z.ai Chat',
  provider: 'z-ai',
  endpoint: '',
  model: '',
  parameters: {
    temperature: 0.7,
    topP: 0.9,
    topK: 40,
    maxTokens: 512,
    contextSize: 4096,
    repetitionPenalty: 1.1,
    frequencyPenalty: 0,
    presencePenalty: 0,
    stopStrings: [],
    stream: true
  },
  isActive: true
};

// Context settings must be defined before defaultSettings
export const defaultContextSettings: ContextSettings = {
  maxMessages: 50,           // Maximum messages in context window
  maxTokens: 4096,           // Token budget for context
  keepFirstN: 1,             // Always keep the greeting
  keepLastN: 20,             // Always keep last 20 messages
  enableSummaries: false,    // Future feature
  summaryThreshold: 40       // When to trigger summarization
};

export const defaultSettings: AppSettings = {
  theme: 'dark',
  fontSize: 16,
  messageDisplay: 'bubble',
  showTimestamps: true,
  showTokens: true,
  autoScroll: true,
  autoSave: true,
  autoSaveInterval: 30000,
  confirmDelete: true,
  defaultBackground: '',
  backgroundFit: 'cover',
  swipeEnabled: true,
  quickReplies: ['Continue', '...', 'Yes', 'No'],
  hotkeys: {
    send: 'Enter',
    newLine: 'Shift+Enter',
    regenerate: 'Ctrl+R',
    swipeLeft: 'ArrowLeft',
    swipeRight: 'ArrowRight'
  },
  sound: {
    enabled: true,
    globalVolume: 0.85,
    maxSoundsPerMessage: 3,
    globalCooldown: 150,
    realtimeEnabled: true
  },
  backgroundTriggers: {
    enabled: true,
    globalCooldown: 250,
    realtimeEnabled: true,
    transitionDuration: 500
  },
  chatLayout: {
    novelMode: true,
    chatWidth: 60,
    chatHeight: 70,
    chatX: 50,
    chatY: 50,
    chatOpacity: 0.95,
    blurBackground: true,
    showCharacterSprite: true
  },
  context: defaultContextSettings
};

export const defaultPromptTemplate: PromptTemplate = {
  id: 'default',
  name: 'Default Template',
  description: 'Standard roleplay template',
  systemPrompt: `You are now in roleplay mode. You will act as {{char}}.
{{#if description}}
Character Description: {{description}}
{{/if}}
{{#if personality}}
Personality: {{personality}}
{{/if}}
{{#if scenario}}
Scenario: {{scenario}}
{{/if}}
Stay in character at all times. Write detailed, engaging responses that reflect {{char}}'s personality and emotions.`,
  userPrompt: '{{user}}',
  assistantPrompt: '{{char}}',
  contextTemplate: `{{#each messages}}
{{#if (eq role 'user')}}{{../userPrompt}}: {{content}}{{/if}}
{{#if (eq role 'assistant')}}{{../assistantPrompt}}: {{content}}{{/if}}
{{/each}}`,
  characterTemplate: `{{name}}'s Persona:
{{description}}

Personality traits: {{personality}}
{{#if scenario}}
Current scenario: {{scenario}}
{{/if}}`,
  groupTemplate: `Multiple characters are present in this conversation.
Characters: {{#each characters}}{{name}}{{#unless @last}}, {{/unless}}{{/each}}

{{#each characters}}
---
{{name}}:
{{description}}
Personality: {{personality}}
{{/each}}`,
  isDefault: true
};

export const defaultPersona: Persona = {
  id: 'default',
  name: 'User',
  description: '',
  avatar: '',
  isActive: true,
  createdAt: new Date().toISOString(),
  updatedAt: new Date().toISOString()
};

export const defaultLorebookSettings: LorebookSettings = {
  scanDepth: 5,
  caseSensitive: false,
  matchWholeWords: false,
  useGroupScoring: false,
  automationId: '',
  tokenBudget: 2048,
  recursionLimit: 3
};
